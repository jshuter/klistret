<project default="generate">
	<!-- Windows -->
	<property name="tmp-destdir" location="C:/temp" />
	<property name="thirdparty-basedir" location="C:/workshop/downloads" />
	<property name="dist-basedir" location="C:/workshop/downloads/klistret" />
	<property name="schema-basedir" location="C:/workshop/klistret/CMDB Core/src/xsd" />
	<property name="config-basedir" location="C:/workshop/klistret/CMDB Core/configuration" />
	<property name="bin-basedir" location="C:\workshop\klistret\CMDB Core\bin" />

	<!-- Linux -->
	<!--
	<property name="schema-basedir" location="/home/matthew/Documents/workspace/klistret/CMDB Core/src/xsd" />
	<property name="tmp-destdir" location="/tmp" />
	<property name="thirdparty-basedir" location="/home/matthew/Documents/software" />
	<property name="dist-basedir" location="/home/matthew/Documents/workspace/klistret/distribution/lib" />
	-->

	<path id="jaxb.class.path">
		<fileset dir="${thirdparty-basedir}/jaxb-ri-20091104/lib">
			<include name="jaxb-api.jar" />
			<include name="jaxb-impl.jar" />
			<include name="jaxb-xjc.jar" />
		</fileset>
	</path>

	<path id="jaxb2-commons.class.path">
		<fileset dir="${thirdparty-basedir}/jaxb2-commons">
			<include name="collection-setter-injector.jar" />
		</fileset>
	</path>

	<path id="jaxb2-basics.class.path">
		<fileset dir="${thirdparty-basedir}/jaxb2-basics-dist-0.5.2/dist">
			<include name="jaxb2-basics-ant-*.jar" />
			<include name="jaxb2-basics-tools-*.jar" />
		</fileset>
	</path>

	<path id="resteasy.class.path">
		<fileset dir="${thirdparty-basedir}/resteasy-jaxrs-1.2.1.GA/lib">
			<include name="resteasy-jettison-provider-1.2.1.GA.jar" />
		</fileset>
	</path>

	<path id="spring.class.path">
		<fileset dir="${thirdparty-basedir}/spring-framework-2.5.6.SEC01/dist">
			<include name="spring.jar" />
		</fileset>
	</path>

	<path id="jakarta-commons.class.path">
		<fileset dir="${thirdparty-basedir}/spring-framework-2.5.6.SEC01/lib/jakarta-commons">
			<include name="commons-beanutils.jar" />
			<include name="commons-lang.jar" />
			<include name="commons-logging.jar" />
		</fileset>
	</path>

	<path id="logging.class.path">
		<fileset dir="${thirdparty-basedir}/slf4j-1.5.10">
			<include name="slf4j-api-1.5.10.jar" />
			<include name="slf4j-log4j12-1.5.10.jar" />
		</fileset>
		<fileset dir="${thirdparty-basedir}/apache-log4j-1.2.15">
			<include name="log4j-1.2.15.jar" />
		</fileset>
		<pathelement location="C:/workshop/klistret/CMDB Core/configuration/runtime" />
	</path>

	<path id="ant-contrib.class.path">
		<fileset dir="${thirdparty-basedir}/ant-contrib">
			<include name="ant-contrib-1.0b3.jar" />
		</fileset>
	</path>

	<path id="klistret.plugin.class.path">
		<fileset dir="${dist-basedir}">
			<include name="klistret.xjc.jar" />
		</fileset>
	</path>

	<target name="generate">

		<java classname="com.sun.tools.xjc.XJCFacade">
			<arg value="-extension" />
			<arg value="-d" />
			<arg value="${tmp-destdir}" />
			<arg value="-b" />
			<arg value="${config-basedir}/build/jaxb.binding.xml" />
			<arg value="${schema-basedir}/pojo.xsd" />
			<arg value="${schema-basedir}/commons.xsd" />
			<arg value="${schema-basedir}/xmlschemaNamespace.xsd" />
			<arg value="${schema-basedir}/element" />
			<arg value="${schema-basedir}/relation" />
			<arg value="-Xcollection-setter-injector" />
			<arg value="-Xinject-code" />
			<arg value="-XxmlRootElement" />
			<arg value="-XxmlRootElement-bases=com.klistret.cmdb.Base,com.klistret.cmdb.pojo.Element,com.klistret.cmdb.pojo.ElementType,com.klistret.cmdb.pojo.Relation,com.klistret.cmdb.pojo.RelationType" />
			<arg value="-XxmlNSMap" />
			<arg value="-XxmlNSMap-targets=com.klistret.cmdb.pojo.Element,com.klistret.cmdb.pojo.Relation" />
			<classpath>
				<path refid="jaxb.class.path" />
				<path refid="jaxb2-commons.class.path" />
				<path refid="jaxb2-basics.class.path" />
				<path refid="resteasy.class.path" />
				<path refid="spring.class.path" />
				<path refid="jakarta-commons.class.path" />
				<path refid="logging.class.path" />
				<path refid="klistret.plugin.class.path" />
			</classpath>
		</java>

		<javac srcdir="${tmp-destdir}" destdir="${tmp-destdir}" debug="on">
			<include name="com/klistret/cmdb/pojo/*.java" />
			<include name="com/klistret/cmdb/*.java" />
			<include name="com/klistret/cmdb/element/**/*.java" />
			<include name="com/klistret/cmdb/relation/**/*.java" />
			<classpath>
				<path refid="jaxb.class.path" />
				<path refid="klistret.plugin.class.path" />
				<path refid="resteasy.class.path" />
				<path location="${bin-basedir}" />
			</classpath>
		</javac>

		<jar destfile="${dist-basedir}/klistret.jaxb.jar" basedir="${tmp-destdir}">
			<include name="com/klistret/cmdb/pojo/*.class" />
			<include name="com/klistret/cmdb/*.class" />
			<include name="com/klistret/cmdb/element/**/*.class" />
			<include name="com/klistret/cmdb/relation/**/*.class" />
		</jar>
	</target>
</project>